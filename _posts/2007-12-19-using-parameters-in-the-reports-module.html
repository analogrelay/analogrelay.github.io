---
disqus_old: true
layout: post
title: "Using Parameters in the Reports Module"
description: ""
category:
tags: []
permalink: /blog/2007/12/19/using-parameters-in-the-reports-module.html
---
<p>A common question that comes up in the Reports Module forums is &quot;How can I display data relevant to the current User in the Reports Module?&quot;. So, I figured I should write a blog post about a feature that has been in the Reports Module for a few versions. When writing your SQL Scripts for the Reports Module, you automatically have access to four parameters: <strong><em>@PortalID</em></strong>, <strong><u><em>@TabID</em></u></strong>, <strong><em>@ModuleID </em></strong>and <strong><em>@UserID</em></strong>. When the SQL Script is executed, these are replaced by the ID of the current Portal, Tab, Module and User (respectively).</p>  <p>So, if you wanted to display a list of Roles for the currently logged in user you could use this script:</p>  <div class="csharpcode" style="font-size: 11pt; background: black; color: white; font-family: consolas">   <p style="margin: 0px"><span style="color: #ff8000">SELECT </span>R.* </p>    <p style="margin: 0px"><span style="color: #ff8000">FROM&#160;&#160; </span>{oQ}UserRoles UR </p>    <p style="margin: 0px">&#160;&#160; <span style="color: #ff8000">INNER JOIN </span>dnn_Roles R </p>    <p style="margin: 0px">&#160;&#160; <span style="color: #ff8000">ON&#160;&#160; </span>&#160;&#160;&#160; UR.RoleID = R.RoleID </p>    <p style="margin: 0px"><span style="color: #ff8000">WHERE&#160; </span>UR.UserID = @UserID</p> </div>  <p>When you run this script, the current user's ID will be substituted in the place of the <strong><em>@UserID</em></strong> parameter. (Note: This is done by SQL Server itself, which avoids SQL Injection attacks). Also, the <strong><em>{oQ}</em></strong> token is replaced with the Object Qualifier configured for your database (if you configured one in your web.config file)</p>  <p>Here's another example. It's a script that retrieves the <strong><em>Website</em></strong> profile property for each user in the current portal.</p>  <div style="font-size: 11pt; background: black; color: white; font-family: consolas">   <p style="margin: 0px"><span style="color: #ff8000">SELECT&#160;&#160;&#160; </span>U.Username,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <em>(<span style="color: #ff8000">SELECT&#160;&#160;&#160; </span>PropertyValue</em></p>    <p style="margin: 0px"><em>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff8000">FROM&#160;&#160; </span>&#160; {oQ}UserProfile <span style="color: #ff8000">AS </span>UP</em></p>    <p style="margin: 0px"><em>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff8000">INNER JOIN </span>{oQ}ProfilePropertyDefinition <span style="color: #ff8000">AS </span>PPD </em></p>    <p style="margin: 0px"><em>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff8000">ON&#160;&#160; </span>&#160;&#160;&#160; PPD.PropertyDefinitionID = UP.PropertyDefinitionID</em></p>    <p style="margin: 0px"><em><span style="color: #ff8000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; WHERE&#160;&#160; </span> UP.UserId = U.UserId</em></p>    <p style="margin: 0px"><em>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff8000">AND&#160;&#160;&#160;&#160;&#160;&#160; </span>PropertyName = <span style="color: lime">'Website'</span></em></p>    <p style="margin: 0px"><em>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff8000">AND&#160;&#160; </span>&#160;&#160; PropertyCategory = <span style="color: lime">'Contact Info'</span>) <span style="color: #ff8000">AS </span><span style="color: lime">'Website'</span></em></p>    <p style="margin: 0px"><span style="color: #ff8000">FROM&#160;&#160; </span>&#160; {oQ}UserPortals <span style="color: #ff8000">AS </span>UP</p>    <p style="margin: 0px"><span style="color: #ff8000">INNER JOIN </span>{oQ}Users <span style="color: #ff8000">AS </span>U </p>    <p style="margin: 0px"><span style="color: #ff8000">ON&#160;&#160; </span>&#160;&#160;&#160; UP.UserId = U.UserId</p>    <p style="margin: 0px"><span style="color: #ff8000">WHERE&#160;&#160; </span> PortalID = @PortalID</p> </div>  <p>The <em>italicized</em> section is the part that actually retrieves the property value, you can replace the <strong><em>PropertyName</em></strong> and <strong><em>PropertyCategory</em></strong> values as you like and repeat this section multiple times to bring back multiple profile properties.</p>  <p>One of the planned future features for the module is to support user-specified parameters. This means you could place a text box, drop down, calendar or other control on the view page for the module and the value of this control would be used as a parameter to the Report. At the moment you're limited to these four parameters, but there's still a lot you can do with them!</p>
