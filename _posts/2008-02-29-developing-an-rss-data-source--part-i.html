---
disqus_old: true
layout: post
title: "Developing an RSS Data Source - Part I"
description: ""
category:
tags: []
permalink: /blog/2008/2/29/developing-an-rss-data-source-part-i.html
---
<P>UPDATE: <A href="/2008/02/29/DevelopingAnRSSDataSourcePartII.aspx">Part II</A> is now available.</p><P>In this series of blogs, I'm going to follow the development of an RSS Data Source. I'm going to use Visual Studio 2008, but I'll be using .Net 2.0 features so you should be able to follow along in Visual Studio 2005. You can also use the Express editions of Visual Web Developer (both 2005 and 2008 versions should work). All the code will be in VB.Net, but it should be straightforward enough for C# developers to understand (after all, its all .Net)</p><H3>Part I - Setting Up</H3><br/><P>First things first, you'll need to install a Source distribution of DotNetNuke. I'm not going to cover that here because there are some other resources out there. You'll also need to install the Source package of the Reports Module. Once you've done this, open your DotNetNuke website up in Visual Studio</p><DIV class=captioned_image><IMG alt="Open Website Dialog" src="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Images/Part1/VS-OpenWebsite.png"> <br/><P class=caption>Figure 1 - Open Website Dialog</P></DIV><br/><P>After opening it, expand the <EM>DesktopModules/Reports/DataSources</EM> folder. You should see something similar to the following</p><DIV class=captioned_image><IMG alt="Data Sources Folder" src="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Images/Part1/VS-DataSourcesFolder.png"> <br/><P class=caption>Figure 2 - Data Sources Folder</P></DIV><br/><P>Each of the folder under the <EM>DataSources</EM> folder represents a different Data Source. So, lets get started and create a folder for our Data Source and call it <EM>RSS</EM>. Inside that folder, we need to create an <EM>App_LocalResources</EM> folder. Visual Studio provides a special menu option to do that:</p><DIV class=captioned_image><IMG alt="Add App_LocalResources Folder menu item" src="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Images/Part1/VS-AddAppLRFolder.png"> <br/><P class=caption>Figure 3 - Add App_LocalResources Folder menu item</P></DIV><br/><P>Inside there, we must create a Resource file. Even if you aren't planning to translate your Data Source into different languages, the Reports Module uses this file to determine the name of your Data Source, so you must create it. In this sample, we aren't going to use the DotNetNuke Localization framework, so this is the only time we'll need to delve into Resource files. Add a new Resource file to the <EM>App_LocalResources </EM>folder called "DataSource.ascx.resx".</p><DIV class=captioned_image><IMG alt="Adding a Resource File" src="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Images/Part1/VS-AddResourceFile.png"> <br/><P class=caption>Figure 4 - Adding a Resource File</P></DIV><br/><P>Open this file and add a new resource key called "DataSourceName.Text" with a value of "RSS".</p><DIV class=captioned_image><IMG alt="Editing the Resource File" src="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Images/Part1/VS-ResourceFileEditor.png"> <br/><P class=caption>Figure 5 - Editing the Resource File</P></DIV><br/><P>We've almost got a running, albeit useless, Data Source. There's only one more file to add. Back in the "RSS" folder, add a Web User Control called "Settings.ascx". Open the Code-behind file (Settings.ascx.vb) and replace the contents with the following code:</P><!--<br/>{rtf1ansiansicpglang1024noproof65001uc1 deff0{fonttbl{f0fnilfcharset0fprq1 Consolas;}}{colortbl;??red204green120blue50;red0green0blue0;red255green255blue255;}??fs26 cf1cb2highlight2 {b Imports}cf3 {b  DotNetNuke.Modules.Reports.Extensions}par ??cf1 {b Imports}cf3 {b  DotNetNuke.Modules.Reports.DataSources}par ??par ??cf1 {b Partial}cf3 {b  }cf1 {b Class}cf3 {b  DesktopModules_Reports_DataSources_RSS_Settings}par ??{b     }cf1 {b Inherits}cf3 {b  ReportsSettingsBase}par ??{b     }cf1 {b Implements}cf3 {b  IDataSourceSettingsControl}par ??par ??par ??{b     }cf1 {b Public}cf3 {b  }cf1 {b ReadOnly}cf3 {b  }cf1 {b Property}cf3 {b  DataSourceClass() }cf1 {b As}cf3 {b  }cf1 {b String}cf3 {b  }cf1 {b Implements}cf3 {b  IDataSourceSettingsControl.DataSourceClass}par ??{b         }cf1 {b Get}par ??cf3 {b             }cf1 {b Return}cf3 {b  }cf1 {b String}cf3 {b .Empty}par ??{b         }cf1 {b End}cf3 {b  }cf1 {b Get}par ??cf3 {b     }cf1 {b End}cf3 {b  }cf1 {b Property}par ??{b End}cf3 {b  }cf1 {b Class}par ??}<br/>--><br/><DIV style="FONT-WEIGHT: bold; FONT-SIZE: 13pt; BACKGROUND: black; COLOR: white; FONT-FAMILY: Consolas"><br/><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">Imports</SPAN> DotNetNuke.Modules.Reports.Extensions</p><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">Imports</SPAN> DotNetNuke.Modules.Reports.DataSources</p><P style="MARGIN: 0px">&nbsp;</p><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">Partial</SPAN> <SPAN style="COLOR: #cc7832">Class</SPAN> DesktopModules_Reports_DataSources_RSS_Settings</p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Inherits</SPAN> ReportsSettingsBase</p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Implements</SPAN> IDataSourceSettingsControl</p><P style="MARGIN: 0px">&nbsp;</p><P style="MARGIN: 0px">&nbsp;</p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Public</SPAN> <SPAN style="COLOR: #cc7832">ReadOnly</SPAN> <SPAN style="COLOR: #cc7832">Property</SPAN> DataSourceClass() <SPAN style="COLOR: #cc7832">As</SPAN> <SPAN style="COLOR: #cc7832">String</SPAN> <SPAN style="COLOR: #cc7832">Implements </SPAN>IDataSourceSettingsControl.DataSourceClass</p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Get</SPAN></p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Return</SPAN> <SPAN style="COLOR: #cc7832">String</SPAN>.Empty</p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">End</SPAN> <SPAN style="COLOR: #cc7832">Get</SPAN></p><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">End</SPAN> <SPAN style="COLOR: #cc7832">Property</SPAN></p><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">End</SPAN> <SPAN style="COLOR: #cc7832">Class</SPAN></P></DIV><br/><P>Save everything and open your Web Browser. Add an instance of the Reports Module to a page and open the Settings page. You should now see the "RSS Data Source" in the Active Data Source drop-down. You can select it, but it doesn't do anything, so don't click Update.</p><H3>Conclusion</H3><br/><P>That's all for part one. I know there isn't anything really useful yet, but I want to keep these parts short. Tomorrow, we'll add the code to retrieve data from an RSS feed.</p><P><A href="https://s3.amazonaws.com/vibrantcode-res/blogcontent/imported/RSSDataSource/Files/Part1.zip">Download the code so far.</A></P>
