---
layout: post
title: "My First Windows 7 Blue-Screen - But it was my fault :P"
description: ""
category:
tags: []
permalink: /blog/2009/1/15/my-first-windows-7-blue-screen-but-it-was-my-fault-p.html
---
<p>I just had my first Windows 7 Blue Screen of Death :(.&#160; However, it was my own fault for trying to use an unsupported driver :P.&#160; I had just listened to an episode of <a href="http://twit.tv/sn" target="_blank">Security Now</a> on a tool called <a href="http://www.sandboxie.com" target="_blank">Sandboxie</a>.&#160; Sandboxie is a tool which intercepts Windows API calls made by programs to read/write files and registry keys.&#160; Once intercepted, Sandboxie redirects them to files and registry keys in a special "Sandbox"?, so that changes made by programs are isolated from each other.&#160; It's a cool security solution, and very similar in spirit to Microsoft's <a href="http://www.microsoft.com/systemcenter/appv/default.mspx" target="_blank">App-V</a> platform (only cheaper, and aimed at consumers rather than enterprises :D).</p>  <p>In order to intercept the Windows API calls, however, Sandboxie has to install a kernel-mode driver and patch the kernel.&#160; In 64-bit versions of Windows, a system called PatchGuard prevents this from happening, thus Sandboxie is not compatible with those operating systems.&#160; However, my laptop is running a 32-bit version of Windows 7, so I decided to try it out.</p>  <p>At first, I got a compatibility message from the Sandboxie installer, telling me that my OS is not supported.&#160; That should have been my first clue :).&#160; I decided to take a gamble and try it out anyway, so I tweaked the compatibility settings for the installer so that it ran in "Windows Vista" compatibility mode.&#160; The installer ran fine, and installed the software.&#160; However, when I tried to run it, BAM, BSOD :(.&#160; </p>  <p>Resigning myself to the fact that it just wasn't ready for Windows 7, I booted up in Safe Mode.&#160; However, I was unable to run the installer again to remove it.&#160; I tried "Add/Remove Programs" and running the installer I downloaded again (in Vista compatibility mode).&#160; Still nothing.&#160; Fortunately, I was just about to restart for Windows Update when I installed Sandboxie, and Windows Update automatically creates a System Restore point before installing updates.&#160; I fired up System Restore, picked the Windows Update restore point and let it do its thing.&#160; The machine rebooted, and I was back in action, with Sandboxie (and my BSODs) gone.&#160; I had lost the updates that WU installed, but that's a minor inconvenience.</p>  <p>Anyway, all is well now, and I was able to boot up again (in order to write this post in fact :D).&#160; So, two lessons here:</p>  <ol>   <li>Use System Restore!&#160; Just remember to make restore points before installing software that you are concerned about.&#160; (Though that will NOT protect you from malicious software, just incompatible software)</li>    <li>Check out Sandboxie, just not on Windows 7 :(.&#160; My theory is that the PatchGuard technology from the 64-bit OS may have been brought into the 32-bit OS.</li> </ol>
