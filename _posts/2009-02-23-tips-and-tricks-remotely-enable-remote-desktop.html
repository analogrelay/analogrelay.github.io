---
disqus_old: true
layout: post
title: "Tips and Tricks: Remotely Enable Remote Desktop"
description: ""
category:
tags: []
permalink: /blog/2009/2/23/tips-and-tricks-remotely-enable-remote-desktop.html
---
<p>Before I start this post, I need to say one thing: <a href="http://blogs.technet.com/markrussinovich/" target="_blank">Mark Russinovich</a> (as well as anyone else who works on the <a href="http://technet.microsoft.com/en-ca/sysinternals/default.aspx" target="_blank">Sysinternals</a> stuff) is a Windows Magician. The stuff these tools can do is just plan magic :).</p>  <p>Last week, my <a href="http://charlesnurse.com/" target="_blank">Dad</a>'s Dell XPS laptop decided it was tired of rendering graphics and the video card just stopped working (apparently this is a known issue). Dell support was fairly helpful and on Friday we received a box to sent the computer in for a motherboard replacement. Now, I'm paranoid when it comes to data, I don't trust anyone. So, I suggested we try and wipe the hard drive of all the sensitive data on the machine, and change the password so that we wouldn't have to give Dell the actual password. Now, only the graphics card was damaged, the computer ran just fine and even the graphics were intermittent (at first). We tried to get the graphics card working long enough to enable remote desktop, so we could connect from his screaming new Dell desktop (Quad Core i7 with 12GB of RAM... I'm jealous). Unfortunately, by that time, the graphics card was done... no dice :(</p>  <p>After a little searching, I came across some tips for enabling remote desktop... remotely. It turns out, there are a number of ways to connect to a machine and make changes remotely! The first tip I found was to use the remote registry to enable it: <a title="http://www.windowsdevcenter.com/pub/a/windows/2004/05/04/serverhacks_remote.html" href="http://www.windowsdevcenter.com/pub/a/windows/2004/05/04/serverhacks_remote.html">http://www.windowsdevcenter.com/pub/a/windows/2004/05/04/serverhacks_remote.html</a>. Unfortunately, the Remote Registry service wasn't running on the laptop! That's when I found Sysinternals "<a href="http://technet.microsoft.com/en-us/sysinternals/bb897542.aspx" target="_blank">PsService</a>" tool. The tool allows you, as long as you have the Admin account password, to enable/disable and change the start mode of services on a remote machine. So, first I enabled to remote registry service</p>  <pre>psservice <a href="file://bilbo">bilbo</a> -u [UserName] start RemoteRegistry</pre><p>Then, just for good measure, I set the Remote Desktop service to autostart</p><pre>psservice <a href="file://bilbo">bilbo</a> -u [UserName] setconfig TermService auto</pre><p>Finally, rather than fight with creating a firewall rule remotely, I just disabled the Windows Firewall service (don't do this unless you absolutely have to :D)</p><pre>psservice <a href="file://bilbo">bilbo</a> -u [UserName] setconfig MpsSvc disabled</pre><p>(Btw, I got all these service names using the Services console on another machine)</p><p>Finally, I followed the instructions I mentioned earlier to set the right registry flags to allow Remote Desktop. I killed the power to the PC (I actually tried Sysinternals "<a href="http://technet.microsoft.com/en-us/sysinternals/bb897541.aspx" target="_blank">PsShutdown</a>" tool first, but had less luck getting that working :D) and restarted it. When I heard the Windows start up sound (as I said, the rest of the components worked just fine :), I fired up remote desktop connection and... bam! I had a remote desktop screen. After a quick pass over the data drive with yet another Sysinternals tool: "<a href="http://technet.microsoft.com/en-us/sysinternals/bb897443.aspx" target="_blank">SDelete</a>" and a password change, we shut the computer down, packed it up and sent it off to Dell, confident that the important data was scrubbed clean.</p><p>Like I said... black magic :). But seriously, the Sysinternals tools rock! If you don't have them, <a href="http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx" target="_blank">get them now</a>!</p>
