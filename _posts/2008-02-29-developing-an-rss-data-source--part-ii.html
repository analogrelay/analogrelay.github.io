---
layout: post
title: "Developing an RSS Data Source - Part II"
description: ""
category:
tags: []
permalink: /blog/2008/2/29/developing-an-rss-data-source-part-ii.html
---
<P>UPDATE: <A href="/2008/03/02/DevelopingAnRSSDataSourcePartIII.aspx">Part III</A> is now available.</P><br/><P>In this series of blogs, I'm going to follow the development of an RSS Data Source. I'm going to use Visual Studio 2008, but I'll be using .Net 2.0 features so you should be able to follow along in Visual Studio 2005. You can also use the Express editions of Visual Web Developer (both 2005 and 2008 versions should work). All the code will be in VB.Net, but it should be straightforward enough for C# developers to understand (after all, its all .Net)</P><br/><P>Continued from <A href="/2008/02/29/DevelopingAnRSSDataSourcePartI.aspx">Part I</A>.</P><br/><H2>Part II - WebRequests, XPath, and Data Tables, oh my!</H2><br/><P>In this part, we're going to add the code to retrieve data from the RSS feed. First, we need to create a folder to hold our code. We're going to put our code in the <EM>App_Code</EM> folder, so it will be compiled automatically by ASP.Net. That way we can save a few extra steps and get straight to the point. You could also put this code in a separate .Net Class Library, and put that library in the Bin folder of your website.</P><br/><P>We'll create a sub-folder inside the App_Code folder for our code and call it <EM>RSSDataSource</EM>:</P><br/><DIV class=captioned_image><IMG alt="Creating an App_Code folder" src="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Images/Part2/VS-AppCodeFolder.png"> <br/><P class=caption>Figure 1 - Creating an App_Code folder</P></DIV><br/><P>Next, we need to tell ASP.Net to compile code found in this folder. Open the <EM>web.config</EM> file, in the root of the website, and find the <EM>&lt;codeSubDirectories&gt;</EM> section (its inside the <EM>&lt;system.web&gt;</EM> section). In my version of DotNetNuke it looks like this, but yours may have different <EM>&lt;add&gt;</EM> entries:</P><!--<br/>{rtf1ansiansicpglang1024noproof1252uc1 deff0{fonttbl{f0fnilfcharset0fprq1 Consolas;}}{colortbl;??red255green255blue255;red0green0blue0;red204green120blue50;red165green194blue92;}??fs26 cf1cb2highlight2 {b       &lt;}cf3 {b codeSubDirectories}cf1 {b &gt;}par ??{b         &lt;}cf3 {b add}cf1 {b  directoryName="}cf4 {b HTML}cf1 {b " /&gt;}par ??{b       &lt;/}cf3 {b codeSubDirectories}cf1 {b &gt;}}<br/>--><br/><DIV style="FONT-WEIGHT: bold; FONT-SIZE: 13pt; BACKGROUND: black; COLOR: white; FONT-FAMILY: Consolas, monospace"><br/><P style="MARGIN: 0px">&lt;<SPAN style="COLOR: #cc7832">codeSubDirectories</SPAN>&gt;</P><br/><P style="MARGIN: 0px">&nbsp; &lt;<SPAN style="COLOR: #cc7832">add</SPAN> directoryName="<SPAN style="COLOR: #a5c25c">HTML</SPAN>" /&gt;</P><br/><P style="MARGIN: 0px">&lt;/<SPAN style="COLOR: #cc7832">codeSubDirectories</SPAN>&gt;</P></DIV><br/><P>We need to add an entry to this list for our new subfolder. On my system, it looks like this (again, yours may vary slightly):</P><!--<br/>{rtf1ansiansicpglang1024noproof65001uc1 deff0{fonttbl{f0fnilfcharset0fprq1 Consolas;}}{colortbl;??red255green255blue255;red0green0blue0;red204green120blue50;red165green194blue92;}??fs26 cf1cb2highlight2 {b       &lt;}cf3 {b codeSubDirectories}cf1 {b &gt;}par ??{b         &lt;}cf3 {b add}cf1 {b  directoryName="}cf4 {b HTML}cf1 {b " /&gt;}par ??{b         &lt;}cf3 {b add}cf1 {b  directoryName="}cf4 {b RSSDataSource}cf1 {b "/&gt;}par ??{b       &lt;/}cf3 {b codeSubDirectories}cf1 {b &gt;}}<br/>--><br/><DIV style="FONT-WEIGHT: bold; FONT-SIZE: 13pt; BACKGROUND: black; COLOR: white; FONT-FAMILY: Consolas, monospace"><br/><P style="MARGIN: 0px">&lt;<SPAN style="COLOR: #cc7832">codeSubDirectories</SPAN>&gt;</P><br/><P style="MARGIN: 0px">&nbsp; &lt;<SPAN style="COLOR: #cc7832">add</SPAN> directoryName="<SPAN style="COLOR: #a5c25c">HTML</SPAN>" /&gt;</P><br/><P style="MARGIN: 0px">&nbsp; &lt;<SPAN style="COLOR: #cc7832">add</SPAN> directoryName="<SPAN style="COLOR: #a5c25c">RSSDataSource</SPAN>"/&gt;</P><br/><P style="MARGIN: 0px">&lt;/<SPAN style="COLOR: #cc7832">codeSubDirectories</SPAN>&gt;</P></DIV><br/><P>Now that we have somewhere to put our code, let's create our Data Source! We'll create a class inside our nice new <EM>App_Code</EM> folder called <EM>RSSDataSource</EM>.</P><br/><P>I'm not going to list the code for the Data Source in this post, because I've attached it to this post. However, I'll go over the general steps.</P><br/><OL><br/><LI>First, we use the <EM>System.Net.WebClient</EM> class to download the RSS feed. For now, I've hardcoded it to one of my favourite blogs: <A href="http://www.hanselman.com/blog/">Scott Hanselman's Computer Zen</A> <br/><LI>Next we create an ADO.Net <EM>DataTable</EM> with three columns: <EM>Title</EM>, <EM>Link</EM> and <EM>Description</EM> <br/><LI>Then, we use the classes in the <EM>System.Xml.XPath</EM> namespace to add a row for each item in the feed to the <EM>DataTable</EM>. <br/><LI>Finally, we wrap the DataTable in a DataView. The Reports Module expects us to return a DataView in order to allow us to do filtering and sorting if we wanted to. We aren't using that feature, so we just create a simple DataView to wrap our table.</LI></OL><br/><P>There's only one last step to hook everything up. We need to tell the Reports Module how to find our Data Source code. To do that, open the code-behind file for <EM>DesktopModules/Reports/DataSources/RSS/Settings.ascx</EM> and change the <EM>DataSourceClass</EM> property to the following code:</P><!--<br/>{rtf1ansiansicpglang1024noproof65001uc1 deff0{fonttbl{f0fnilfcharset0fprq1 Consolas;}}{colortbl;??red255green255blue255;red0green0blue0;red204green120blue50;}??fs26 cf1cb2highlight2 {b     }cf3 {b Public}cf1 {b  }cf3 {b ReadOnly}cf1 {b  }cf3 {b Property}cf1 {b  DataSourceClass() }cf3 {b As}cf1 {b  }cf3 {b String}cf1 {b  }cf3 {b Implements}cf1 {b  IDataSourceSettingsControl.DataSourceClass}par ??{b         }cf3 {b Get}par ??cf1 {b             }cf3 {b Return}cf1 {b  }cf3 {b GetType}cf1 {b (RSSDataSource).FullName}par ??{b         }cf3 {b End}cf1 {b  }cf3 {b Get}par ??cf1 {b     }cf3 {b End}cf1 {b  }cf3 {b Property}}<br/>--><br/><DIV style="FONT-WEIGHT: bold; FONT-SIZE: 13pt; BACKGROUND: black; COLOR: white; FONT-FAMILY: Consolas"><br/><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">Public</SPAN> <SPAN style="COLOR: #cc7832">ReadOnly</SPAN> <SPAN style="COLOR: #cc7832">Property</SPAN> DataSourceClass() <SPAN style="COLOR: #cc7832">As</SPAN> <SPAN style="COLOR: #cc7832">String</SPAN> <SPAN style="COLOR: #cc7832">Implements</SPAN> IDataSourceSettingsControl.DataSourceClass</P><br/><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Get</SPAN></P><br/><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">Return</SPAN> <SPAN style="COLOR: #cc7832">GetType</SPAN>(RSSDataSource).FullName</P><br/><P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #cc7832">End</SPAN> <SPAN style="COLOR: #cc7832">Get</SPAN></P><br/><P style="MARGIN: 0px"><SPAN style="COLOR: #cc7832">End</SPAN> <SPAN style="COLOR: #cc7832">Property</SPAN></P></DIV><br/><P>And with that, we have a working RSS Data Source! Go back to your browser and go to the Settings page for the Reports Module instance we created in Part 1. Select the RSS Data Source as the <EM>Active Data Source</EM>, and click update. You should see a very wide grid containing the data from the RSS feed (assuming you are using the Grid Visualizer, which is the default):</P><br/><DIV class=captioned_image><IMG alt="Simple Grid View" src="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Images/Part2/IE-GridNoDecode.png"> <br/><P class=caption>Figure 2 - Simple Grid View</P></DIV><br/><P>Well, that doesn't look very useful does it? Let's start by getting rid of that HTML junk in the Description field. To get rid of that, go back to the Settings page, and add "Description" to the list of columns to HTML Decode.</P><br/><DIV class=captioned_image><IMG alt="HTML Decode Converter" src="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Images/Part2/IE-HtmlDecodeSetting.png"> <br/><P class=caption>Figure 3 - HTML Decode Converter</P></DIV><br/><P>That should clean up the HTML, but it's still a big grid. Let's use the HTML Visualizer to clean it up a bit. Put the following code in an HTML file and place it in your <EM>Portals/[PortalID]</EM> folder:</P><!--<br/>{rtf1ansiansicpglang1024noproof65001uc1 deff0{fonttbl{f0fnilfcharset0fprq1 Consolas;}}{colortbl;??red255green255blue255;red0green0blue0;red232green188blue100;red165green194blue92;}??fs26 cf1cb2highlight2 {b &lt;}cf3 {b h1}cf1 {b &gt;&lt;}cf3 {b a}cf1 {b  href=}cf4 {b "[Link]"}cf1 {b &gt;[Title]&lt;/}cf3 {b a}cf1 {b &gt;&lt;/}cf3 {b h1}cf1 {b &gt;}par ??{b [Description]}par ??{b &lt;}cf3 {b hr}cf1 {b  /&gt;}}<br/>--><br/><DIV style="FONT-WEIGHT: bold; FONT-SIZE: 13pt; BACKGROUND: black; COLOR: white; FONT-FAMILY: Consolas"><br/><P style="MARGIN: 0px">&lt;<SPAN style="COLOR: #e8bc64">h1</SPAN>&gt;&lt;<SPAN style="COLOR: #e8bc64">a</SPAN> href=<SPAN style="COLOR: #a5c25c">"[Link]"</SPAN>&gt;[Title]&lt;/<SPAN style="COLOR: #e8bc64">a</SPAN>&gt;&lt;/<SPAN style="COLOR: #e8bc64">h1</SPAN>&gt;</P><br/><P style="MARGIN: 0px">[Description]</P><br/><P style="MARGIN: 0px">&lt;<SPAN style="COLOR: #e8bc64">hr</SPAN> /&gt;</P></DIV><br/><P>Then, go back to the Settings page, select the HTML Template Visualizer and the HTML file you just uploaded:</P><br/><DIV class=captioned_image><IMG alt="Configuring the HTML Visualizer" src="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Images/Part2/IE-HtmlTemplate.png"> <br/><P class=caption>Figure 4 - Configuring the HTML Visualizer</P></DIV><br/><P>Click Update and you should see a much more readable display. It's almost like a real RSS Reader!</P><br/><DIV class=captioned_image><IMG alt="A Reports Module-powered RSS Reader?" src="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Images/Part2/IE-RSSReader.png"> <br/><P class=caption>Figure 5 - A Reports Module-powered RSS Reader!</P></DIV><br/><H3>Conclusion</H3><br/><P>Well, that's all for part two. Next, we'll cover Data Source settings so that we can point our Data Source at any RSS feed we want, rather than hard coding it. Then, we add an HTML Decoding feature directly into the Data Source so we don't have to configure the module to decode the Description field. Finally, we'll package it all up so that others can download and install it.</P><br/><P><A href="http://dl.dropbox.com/u/17594081/BlogContent/03082011-Import/RSSDataSource/Files/Part2.zip">Download the code so far.</A></P>
